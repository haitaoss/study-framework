// gradle -Pprofile=task-rule pingServer1
def init = {
    tasks.register('pingServer1') {
        doLast {
            println 'pingServer1....'
        }
    }
    tasks.register('pingServer2') {
        doLast {
            println 'pingServer2....'
        }
    }
}
def f1 = {

    // 任务规则
    tasks.addRule("Pattern: ping<ID>") { String taskName ->

        if (taskName.startsWith("ping")) {
            task(taskName) {
                doLast {
                    println "Pinging: " + (taskName - 'ping')
                }
            }
        }
    }
}

// 对基于规则的任务的依赖性
def f2 = {
    tasks.addRule("Pattern: ping<ID>") { String taskName ->
        println taskName
        if (taskName.startsWith("ping")) {
            task(taskName) {
                doLast {
                    println "Pinging: " + (taskName - 'ping')
                }
            }
        }
    }

    tasks.register('groupPing') {
        dependsOn 'pingServer1', 'pingServer2'
    }
}
f1() // gradle -Pprofile=task-rule pingServer1 -q
//f2() // gradle -Pprofile=task-rule groupPing -q
init()
